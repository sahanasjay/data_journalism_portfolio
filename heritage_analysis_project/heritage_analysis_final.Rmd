---
title: "confederate monuments analysis"
author: "Sahana Jayaraman, Tori Bergel, Theresa Cotton, and Manuela Lopez Restrepo" 
date: "12/13/2020"
output: 
  html_document:
    code_folding: hide
    toc: true
    toc_depth: 3
    toc_float: true
    df_print: paged
  md_document:
    variant: markdown_github
    toc: true
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

The purpose of this document is to display the analysis behind the five findings that generated the story group 2 pitched for our final. Each finding is a header, with the code that engineers that finding listed below with line-by-line descriptions. Using the Southern Poverty Law Center's Whose Heritage dataset, our story centers on 3 trees in California, all named after Robert E. Lee. 

##Load Libraries 
```{r}
# install.packages("leaflet")

# For general data analysis
library(tidyverse)

# For cleaning data 
library(janitor)

# For creating a map
library(leaflet)

```

##Loading in the data 
# All code in this chunk written by Sahana Jayaraman
```{r}
# Reading in the data and converting the coordinates column into two separate numeric columns for latitude and longitude so leaflet can map
heritage<- read_csv("data/whose_heritage.csv")%>%
  clean_names()%>%
  separate(coordinates, into = c("lat", "lng"),sep =",")%>%
  mutate(lat = as.numeric(lat), 
         lng = as.numeric(lng))

# Cleaning data frame so that each state falls into one category — "South" or "North" or "Not Applicable" — to better view the number of monuments that fall into each category (monuments in union states v. monuments in confederate states)
side<-heritage%>%
  rename(clean_side = side)%>%
  group_by(state, clean_side)%>%
  count()%>%
  filter(!is.na(clean_side))%>%
  arrange(state)%>%
  mutate(clean_side = case_when(
    state =="AL" ~ "South", 
    state =="AR" ~ "South",
    state == "TX" ~ "South",
    state == "VA" ~ "South",
    TRUE ~ clean_side
  ))%>%
  select(-n)%>%
  distinct()


# Join cleaned side with heritage 
heritage<- heritage%>%
  inner_join(side, by = c("state"))%>%
  select(-side)%>%
  rename(side = clean_side)


```
## Finding #1: Northern states, while they have less monuments than southern states, have a higher percentage of symbols removed. 
## All code in this chunk written by Sahana Jayaraman. 
```{r}
#Q: How many monuments by region? 
# Start with Heritage dataset
heritage%>%
# Get the number of monuments in each region 
  group_by(side)%>%
  count()%>%
# Arrange the list so the region with the most monuments is at the top.
  arrange(desc(n))
#A: total number of monuments: Union (northern) states = 46, Confederate (southern) states = 1757, border states = 98, "not applicable" states = 39

#Q: What percentage of monuments removed per region (the North vs. the South)? 
#Create a new object called percent removed, feeding it the heritage dataset 
percent_removed<-heritage%>%
# Get number of monuments removed vs. not removed by region 
  group_by(side, tracking_status)%>%
# Re-code variables so that symbols where statues were removed but pedestals remain and renamed symbols show up as "removed"
  mutate(tracking_status = case_when(
    tracking_status =="Live (Statue Removed; Pedestal Remains)" ~ "Removed", 
    tracking_status =="Renamed" ~ "Removed", 
    TRUE ~ tracking_status
  ))%>%
  count()%>%
# Pivot the table wider to divide removed symbols by live symbols and take a percentage
  pivot_wider(names_from = tracking_status, values_from = n)%>%
  clean_names()%>%
  mutate(percent_removed = (removed / live)*100)
# Print results 
percent_removed
# A: Shows the percent removed in each category - for the purpose of this exercise, we counted "renamed" and "statue removed" under the umbrella term "removed." Percentage of monuments removed in northern states is much higher than in southern states; southern states have relocated a notable number of monuments and the status on 4 are pending. 
```


##Finding #2: California is the Union state with the most confederate symbols
```{r}

# Q: Which Northern(Union) state has the most confederate monuments?
# Creating a new object called "northern_states" and feeding it the heritage dataset 
northern_states<- heritage%>%
# Returning northern states and grouping by state to find the state with the most conferderate monuments 
  filter (side =="North")%>%
  group_by(state)%>%
  summarise(count = n())%>%
  arrange(desc(count))
# Printing results
northern_states
# A: California has the most monuments — so we're focusing in on Cali 
```



##Finding #3:Though nearly half of the monuments in California have been removed since 2016, the data says three trees remain 
```{r}
# Q: How many monuments in Cali have come down?
# Create new object called 'cali_monuments_down' and feed it the heritage dataframe 
cali_monuments_down <- heritage %>%
# Filter state to return rows in California that have been removed or renamed 
  filter(state == "CA") %>%
  filter(tracking_status %in% c("Removed", "Renamed"))%>%
  group_by(year_removed)%>%
  count()
# Print results
cali_monuments_down
# A: 6 have been removed or renamed, starting in 2016 and the latest removed in 2020. California has 14 monuments total, so nearly half have been removed 

# Q: What monuments are still live? 
# Filter out live monuments in California and count
cali_live_monuments <-heritage %>%
  filter(state== "CA", tracking_status == "Live")%>%
  group_by(symbol_type, symbol_category)%>%
  count()%>%
  arrange(desc(n))
# Print results 
cali_live_monuments 
# A: The most still-live monuments are parks/trails, 

# Q: Exploring parks/trails:
heritage%>%
  filter(state== "CA", tracking_status == "Live", symbol_category == "Parks/Trails")
# A: all the parks/trails symbols remaining are trees
```



##Finding #4: All three of these trees are named after Robert E. Lee, and they are all sequoias. One was named in 1875, and another named much later in 1937. We don't know when one tree was named. All three of them are located in federal national parks. 
```{r}

#Q: What do we know about the trees? 
# Filter the heritage dataframe to return Live California monuments that are parks/trails 

heritage%>%
  filter(state== "CA", tracking_status == "Live", symbol_category == "Parks/Trails")

# A: All three live monuments in the parks/trails category  are trees
# A: Two trees are dedicated or named in 1875 or 1937 (missing data for Yosemite National Park tree)
# A; They're all same type of tree (Sequoia)
# A: The trees have not been removed or renamed since their dedication (live tracking status)
# A: Sponsors are different (One is Richard Field and one is United Daughters of the Confederacy and one is NA)
# The three trees are located in Sequoia National Park, Kings Canyon National Park, and Yosemite National Park and they're all dedicated to Robert E. Lee.
```

# All code in this chunk written by Sahana Jayaraman
```{r}

# Q: Can we see the trees on a map? 
# Create new object three_trees and feed in dataset 'heritage' 
three_trees<-heritage%>%
# Filter to return the three trees 
  filter(symbol_type == "Other", state == "CA", honorees == "Robert E. Lee" )%>%
# Recode variables in column "feature_name" so all the trees are labeled "tree"
  mutate( feature_name = case_when(
    feature_name == "Robert E. Lee Sequoia Tree at Sequoia National Park" ~ "tree", 
    feature_name == "Robert E. Lee Sequoia Tree at Kings Canyon National Park" ~ "tree",
      feature_name == "Robert E. Lee Sequoia Tree at Yosemite National Park" ~ "tree",
    ))
# Print results
three_trees

# Use leaflet and the lat/long positions of each tree to create a map, where each tree is labeled by its unique ID
three_trees%>%
  leaflet()%>%
  addProviderTiles(provider = "CartoDB.Positron")%>%
  addMarkers(lat = ~lat, lng = ~lng, 
             label = ~unique_id)
# Note: Two of the trees are missing lat/lng values and can't be mapped, so they don't show up.
```


## Finding #5: That there are trees in other states named after confederate generals, but it appears that california has the most. 
# All code in this chunk written by Sahana Jayaraman
```{r}

#Q: Are there trees in other states named after confederate generals? 
# Create  object called 'american_trees' and feed in heritage dataset  
american_trees<-heritage%>%
# Recode the feature names of oaks and other trees to show up as "tree" and filter 
  mutate( feature_name = case_when(
    feature_name == "Robert E. Lee Memorial Tree" ~ "tree",
    feature_name == "Robert E. Lee Sequoia Tree at Sequoia National Park" ~ "tree", 
    feature_name == "Robert E. Lee Sequoia Tree at Kings Canyon National Park" ~ "tree",
    feature_name == "Robert E. Lee Sequoia Tree at Yosemite National Park" ~ "tree",
    feature_name == "Confederate Oak" ~ "tree",
    feature_name == "Lee Oak (Tree)" ~ "tree",
    TRUE ~ feature_name
    ))%>%
  filter( feature_name == "tree")%>%
  group_by(state)%>%
  count()

american_trees
# A: There are other trees in other states named after confederate soldiers/generals, but California appears to have the most 
```
